<?xml version="1.0" encoding="UTF-8" standalone="no"?><beast beautitemplate='Standard' beautistatus='' namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="" version="2.6">
<!-- based on the following template: https://github.com/gavryushkina/sampled-ancestor-bdsky/blob/master/templates/SAFBDSKY.xml - FBD skyline -->
<!-- see also: https://taming-the-beast.org/tutorials/FBD-tutorial/FBD-tutorial.pdf - alternative parameterisation, fossil age uncertainty and offset  -->
<!-- see also: https://github.com/fkmendes/contraband/blob/master/examples/testing/BMPruneLikelihood.xml - multiple traits, BM model, contraband package -->
<!-- see also: https://github.com/fkmendes/contraband/blob/master/examples/testing/BMMVNShiftLikelihoodOneTrait_FBDTree_RateCatClock.xml - multiple rate categories, nCat = 2, contraband package -->

<!-- ** Data and taxon names ** -->
<data
    id="dnaSequence"
    spec="Alignment"
    name="alignment">

    <!-- Empty sequence alignment -->
    <sequence id="1" taxon="TS01_LEpigrav_ASH_Nadap_DobosiEtAl1988_AR_na_3_pseudo_no_18" totalcount="4" value="N"/>
<sequence id="2" taxon="TS1_Cres_GBS_ThreeHolesCave_BartonRoberts1996_AR_na_1_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="3" taxon="TS1_EAzil_SWF_Murat_Lorblanchet1985u1996_AR_na_1_pseudo_no_2" totalcount="4" value="N"/>
<sequence id="4" taxon="TS1_FMag_IBM_ParcoII_Langlais2007_AR_na_1_pseudo_no_20" totalcount="4" value="N"/>
<sequence id="5" taxon="TS1_LEpigrav_ASH_Zoeld_BeresEtAl2020_AR_p_1_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="6" taxon="TS1_Mag_PL_Klementowice20_WisniewskiT2015_AR_na_9_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="7" taxon="TS1_TransMag_SG_Felsstalle_Kind1987_AR_d_1_pseudo_no_9" totalcount="4" value="N"/>
<sequence id="8" taxon="TS1_TransMag_SG_ZigeunerfelsFG_HornauerJahnkeNoack2019_AR_d_1_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="9" taxon="TS1_UMag_SWF_BoisRagot_Langlais2018_AR_na_1_pseudo_no_22" totalcount="4" value="N"/>
<sequence id="10" taxon="TS2_FMag_IBA_LapadosCoelhos3_Gameiro2012_AR_d_1_pseudo_no_2" totalcount="4" value="N"/>
<sequence id="11" taxon="TS2_Hav_NG_AhrenshoeftLA58d_Weberetal2010fig7_AR_d_1_pseudo_no_3" totalcount="4" value="N"/>
<sequence id="12" taxon="TS2_Mag_BOMO_Kulna6_Valoch1998_AR_d_1_pseudo_no_7" totalcount="4" value="N"/>
<sequence id="13" taxon="TS23_EAzil_CH_GrottedeBichon_Chauviere2008_AR_d_1_pseudo_no_5" totalcount="4" value="N"/>
<sequence id="14" taxon="TS3_Brom_SS_Bromme_Mathiassen1946p1_AR_na_1_pseudo_no_5" totalcount="4" value="N"/>
<sequence id="15" taxon="TS3_LEpigrav_NEI_PaluEchen_Dalmerietal2013_AR_d_1_pseudo_no_4" totalcount="4" value="N"/>
<sequence id="16" taxon="TS3_LEpigrav_NEI_RiparoDalmeriUpperlayers_Bassettietal1998_AR_na_1_pseudo_no_21" totalcount="4" value="N"/>
<sequence id="17" taxon="TS3_Sauv_IBM_CingledelAigua_Roman2011_AR_na_1_pseudo_no_18" totalcount="4" value="N"/>
<sequence id="18" taxon="TS3_Sauv_IBM_Pena14_Sotoetal2019_AR_na_1_pseudo_no_13" totalcount="4" value="N"/>
<sequence id="19" taxon="TS3_Wito_PL_Rotnowo18ll_Galinski2007_AR_p_1_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="20" taxon="TS34_LPal_SG_BadBuchauKappel_Joachimetal2015_AR_p_1_pseudo_no_2" totalcount="4" value="N"/>
<sequence id="21" taxon="TS4_Ahr_SS_SyltholmVII_Mage2019_AR_na_1_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="22" taxon="TS4_AzilTSG_ASH_Unken_Windisch2014_AR_d_1_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="23" taxon="TS4_BeurA_SG_JagerhaushohleSchicht13_Taute1971_AR_na_1_pseudo_no_30" totalcount="4" value="N"/>
<sequence id="24" taxon="TS4_ELab_SWF_PortdePenne_Langlais2020_AR_d_1_pseudo_no_5" totalcount="4" value="N"/>
<sequence id="25" taxon="TS4_ESauv_NEI_RomagnanoLocIIIlayerAE_Bartolomeietal1984_AR_na_1_pseudo_no_45" totalcount="4" value="N"/>
<sequence id="26" taxon="TS4_LAzil_IBA_Bocas0_Bicho1999_AR_na_1_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="27" taxon="TS4_REpigrav_ASH_Altwasser_JagherFischerMorel1997_AR_na_3_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="28" taxon="TS4_Swid_LT_Kabeliai2_Ostrauskas2002_AR_d_1_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="29" taxon="TS4_SwidAhr_PL_Kochlew1_Cyrek1996_AR_d_2_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="30" taxon="TS4_SwidAhr_PL_WojnowoAcutIII75_Kobusiewicz2016_AR_d_4_pseudo_no_1" totalcount="4" value="N"/>
<sequence id="31" taxon="TS45_FBT_GBS_ThreeWaysWharfCWest_LewisandRackham2011_AR_p_1_pseudo_no_14" totalcount="4" value="N"/>
<sequence id="32" taxon="TS5_EMeso_GBS_StarCarr_Milneretal2018_AR_na_1_pseudo_no_4" totalcount="4" value="N"/>


</data>

<map name="Uniform">beast.math.distributions.Uniform</map>
<map name="Exponential">beast.math.distributions.Exponential</map>
<map name="LogNormal">beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal">beast.math.distributions.Normal</map>
<map name="Beta">beast.math.distributions.Beta</map>
<map name="Gamma">beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution">beast.math.distributions.LaplaceDistribution</map>
<map name="prior">beast.math.distributions.Prior</map>
<map name="InverseGamma">beast.math.distributions.InverseGamma</map>
<map name="OneOnX">beast.math.distributions.OneOnX</map>
<map name="Dirichlet">beast.math.distributions.Dirichlet</map>

<run id="mcmc" spec="MCMC" chainLength="5000000000">

    <!-- ** Declare model parameters and variables, plus some starting values ** -->  
    <state id="state" spec="State" storeEvery="500000">

        <tree id="TheTree" spec="beast.evolution.tree.Tree" name="stateNode">

            <taxonset id="TaxonSet" spec="TaxonSet">
                <taxon id="TS01_LEpigrav_ASH_Nadap_DobosiEtAl1988_AR_na_3_pseudo_no_18" spec="Taxon"/>
<taxon id="TS1_Cres_GBS_ThreeHolesCave_BartonRoberts1996_AR_na_1_pseudo_no_1" spec="Taxon"/>
<taxon id="TS1_EAzil_SWF_Murat_Lorblanchet1985u1996_AR_na_1_pseudo_no_2" spec="Taxon"/>
<taxon id="TS1_FMag_IBM_ParcoII_Langlais2007_AR_na_1_pseudo_no_20" spec="Taxon"/>
<taxon id="TS1_LEpigrav_ASH_Zoeld_BeresEtAl2020_AR_p_1_pseudo_no_1" spec="Taxon"/>
<taxon id="TS1_Mag_PL_Klementowice20_WisniewskiT2015_AR_na_9_pseudo_no_1" spec="Taxon"/>
<taxon id="TS1_TransMag_SG_Felsstalle_Kind1987_AR_d_1_pseudo_no_9" spec="Taxon"/>
<taxon id="TS1_TransMag_SG_ZigeunerfelsFG_HornauerJahnkeNoack2019_AR_d_1_pseudo_no_1" spec="Taxon"/>
<taxon id="TS1_UMag_SWF_BoisRagot_Langlais2018_AR_na_1_pseudo_no_22" spec="Taxon"/>
<taxon id="TS2_FMag_IBA_LapadosCoelhos3_Gameiro2012_AR_d_1_pseudo_no_2" spec="Taxon"/>
<taxon id="TS2_Hav_NG_AhrenshoeftLA58d_Weberetal2010fig7_AR_d_1_pseudo_no_3" spec="Taxon"/>
<taxon id="TS2_Mag_BOMO_Kulna6_Valoch1998_AR_d_1_pseudo_no_7" spec="Taxon"/>
<taxon id="TS23_EAzil_CH_GrottedeBichon_Chauviere2008_AR_d_1_pseudo_no_5" spec="Taxon"/>
<taxon id="TS3_Brom_SS_Bromme_Mathiassen1946p1_AR_na_1_pseudo_no_5" spec="Taxon"/>
<taxon id="TS3_LEpigrav_NEI_PaluEchen_Dalmerietal2013_AR_d_1_pseudo_no_4" spec="Taxon"/>
<taxon id="TS3_LEpigrav_NEI_RiparoDalmeriUpperlayers_Bassettietal1998_AR_na_1_pseudo_no_21" spec="Taxon"/>
<taxon id="TS3_Sauv_IBM_CingledelAigua_Roman2011_AR_na_1_pseudo_no_18" spec="Taxon"/>
<taxon id="TS3_Sauv_IBM_Pena14_Sotoetal2019_AR_na_1_pseudo_no_13" spec="Taxon"/>
<taxon id="TS3_Wito_PL_Rotnowo18ll_Galinski2007_AR_p_1_pseudo_no_1" spec="Taxon"/>
<taxon id="TS34_LPal_SG_BadBuchauKappel_Joachimetal2015_AR_p_1_pseudo_no_2" spec="Taxon"/>
<taxon id="TS4_Ahr_SS_SyltholmVII_Mage2019_AR_na_1_pseudo_no_1" spec="Taxon"/>
<taxon id="TS4_AzilTSG_ASH_Unken_Windisch2014_AR_d_1_pseudo_no_1" spec="Taxon"/>
<taxon id="TS4_BeurA_SG_JagerhaushohleSchicht13_Taute1971_AR_na_1_pseudo_no_30" spec="Taxon"/>
<taxon id="TS4_ELab_SWF_PortdePenne_Langlais2020_AR_d_1_pseudo_no_5" spec="Taxon"/>
<taxon id="TS4_ESauv_NEI_RomagnanoLocIIIlayerAE_Bartolomeietal1984_AR_na_1_pseudo_no_45" spec="Taxon"/>
<taxon id="TS4_LAzil_IBA_Bocas0_Bicho1999_AR_na_1_pseudo_no_1" spec="Taxon"/>
<taxon id="TS4_REpigrav_ASH_Altwasser_JagherFischerMorel1997_AR_na_3_pseudo_no_1" spec="Taxon"/>
<taxon id="TS4_Swid_LT_Kabeliai2_Ostrauskas2002_AR_d_1_pseudo_no_1" spec="Taxon"/>
<taxon id="TS4_SwidAhr_PL_Kochlew1_Cyrek1996_AR_d_2_pseudo_no_1" spec="Taxon"/>
<taxon id="TS4_SwidAhr_PL_WojnowoAcutIII75_Kobusiewicz2016_AR_d_4_pseudo_no_1" spec="Taxon"/>
<taxon id="TS45_FBT_GBS_ThreeWaysWharfCWest_LewisandRackham2011_AR_p_1_pseudo_no_14" spec="Taxon"/>
<taxon id="TS5_EMeso_GBS_StarCarr_Milneretal2018_AR_na_1_pseudo_no_4" spec="Taxon"/>

            </taxonset>

            <!-- Insert age data, use data-backward for macroevolution -->
            <!-- If you do not place priors and operators on the sample ages, they will be fixed to the values specified here -->
            <!-- In this example, all ages fixed. Tree scaled to age of youngest sample -->
            <trait id="FossilSet" spec="beast.evolution.tree.TraitSet" traitname="date-backward">                       
                TS01_LEpigrav_ASH_Nadap_DobosiEtAl1988_AR_na_3_pseudo_no_18=4.619,
TS1_Cres_GBS_ThreeHolesCave_BartonRoberts1996_AR_na_1_pseudo_no_1=3.128,
TS1_EAzil_SWF_Murat_Lorblanchet1985u1996_AR_na_1_pseudo_no_2=3.786,
TS1_FMag_IBM_ParcoII_Langlais2007_AR_na_1_pseudo_no_20=4.492,
TS1_LEpigrav_ASH_Zoeld_BeresEtAl2020_AR_p_1_pseudo_no_1=4.43,
TS1_Mag_PL_Klementowice20_WisniewskiT2015_AR_na_9_pseudo_no_1=4.164,
TS1_TransMag_SG_Felsstalle_Kind1987_AR_d_1_pseudo_no_9=3.656,
TS1_TransMag_SG_ZigeunerfelsFG_HornauerJahnkeNoack2019_AR_d_1_pseudo_no_1=3.22,
TS1_UMag_SWF_BoisRagot_Langlais2018_AR_na_1_pseudo_no_22=4.006,
TS2_FMag_IBA_LapadosCoelhos3_Gameiro2012_AR_d_1_pseudo_no_2=2.5,
TS2_Hav_NG_AhrenshoeftLA58d_Weberetal2010fig7_AR_d_1_pseudo_no_3=2.899,
TS2_Mag_BOMO_Kulna6_Valoch1998_AR_d_1_pseudo_no_7=3.645,
TS23_EAzil_CH_GrottedeBichon_Chauviere2008_AR_d_1_pseudo_no_5=2.445,
TS3_Brom_SS_Bromme_Mathiassen1946p1_AR_na_1_pseudo_no_5=1.686,
TS3_LEpigrav_NEI_PaluEchen_Dalmerietal2013_AR_d_1_pseudo_no_4=1.125,
TS3_LEpigrav_NEI_RiparoDalmeriUpperlayers_Bassettietal1998_AR_na_1_pseudo_no_21=2.057,
TS3_Sauv_IBM_CingledelAigua_Roman2011_AR_na_1_pseudo_no_18=1.526,
TS3_Sauv_IBM_Pena14_Sotoetal2019_AR_na_1_pseudo_no_13=0.986,
TS3_Wito_PL_Rotnowo18ll_Galinski2007_AR_p_1_pseudo_no_1=1.985,
TS34_LPal_SG_BadBuchauKappel_Joachimetal2015_AR_p_1_pseudo_no_2=0.507,
TS4_Ahr_SS_SyltholmVII_Mage2019_AR_na_1_pseudo_no_1=0.475,
TS4_AzilTSG_ASH_Unken_Windisch2014_AR_d_1_pseudo_no_1=2.139,
TS4_BeurA_SG_JagerhaushohleSchicht13_Taute1971_AR_na_1_pseudo_no_30=0.185,
TS4_ELab_SWF_PortdePenne_Langlais2020_AR_d_1_pseudo_no_5=1.19,
TS4_ESauv_NEI_RomagnanoLocIIIlayerAE_Bartolomeietal1984_AR_na_1_pseudo_no_45=0.081,
TS4_LAzil_IBA_Bocas0_Bicho1999_AR_na_1_pseudo_no_1=0.365,
TS4_REpigrav_ASH_Altwasser_JagherFischerMorel1997_AR_na_3_pseudo_no_1=0.733,
TS4_Swid_LT_Kabeliai2_Ostrauskas2002_AR_d_1_pseudo_no_1=0.333,
TS4_SwidAhr_PL_Kochlew1_Cyrek1996_AR_d_2_pseudo_no_1=1.033,
TS4_SwidAhr_PL_WojnowoAcutIII75_Kobusiewicz2016_AR_d_4_pseudo_no_1=1.076,
TS45_FBT_GBS_ThreeWaysWharfCWest_LewisandRackham2011_AR_p_1_pseudo_no_14=0.654,
TS5_EMeso_GBS_StarCarr_Milneretal2018_AR_na_1_pseudo_no_4=0
                <taxa idref="TaxonSet"/>
            </trait>
            
        </tree>

        <!-- FBD model -->
        <parameter id="birthRateFBD" lower="0.0" name="stateNode">1.0 1.0 1.0 1.0</parameter> <!-- change required here for FBD skyline, add starting values for each interval-->
        <parameter id="deathRateFBD" lower="0.0" name="stateNode">1.0 1.0 1.0 1.0</parameter>
        <parameter id="samplingRateFBD" lower="0.0" name="stateNode">0.1 0.1 0.1 0.1</parameter>
        <parameter id="originFBD" lower="0.0" name="stateNode">18.982</parameter>      
        <!-- BM-model state nodes-->
        <stateNode idref="rootValues"/>
        <stateNode idref="varValues"/>        
        <stateNode idref="covValues"/>
        <!--Clock model -->
        <stateNode idref="rateValues"/>
        <stateNode idref="rateAssignments"/>        
        
    </state>

    <!-- Starting tree block -->
    <init id="RandomTheTree" spec="beast.evolution.tree.RandomTree" estimate="false" initial="@TheTree" taxa="@dnaSequence">
        <populationModel id="ConstantPopulation0.t" spec="ConstantPopulation">
            <parameter id="randomPopSize.t" spec="parameter.RealParameter" name="popSize">1.0</parameter>
        </populationModel>
    </init>

    <!-- ** The Posterior ** -->
    <!-- Specify your posterior, within this you'll specify your prior and likelihood -->
    <distribution id="posterior" spec="util.CompoundDistribution">

        <!-- ** The Priors ** -->
        <distribution id="prior" spec="util.CompoundDistribution">

            <!-- the tree prior, the FBD skyline model, change spec --> 
            <distribution id="FBD" spec="beast.evolution.speciation.BirthDeathSkylineModel" conditionOnRhoSampling="false"  birthRate="@birthRateFBD" deathRate="@deathRateFBD" samplingRate="@samplingRateFBD" origin="@originFBD" tree="@TheTree">
                <parameter id="rFBD" estimate="false" lower="0.0" name="removalProbability" upper="1.0">0.0</parameter>
                <parameter id="rhoFBD" estimate="false" lower="0.0" name="rho" upper="1.0">0.0</parameter>
                <!-- change required here for FBD skyline, add change times, last entry must always be zero -->
                <parameter name="birthRateChangeTimes" id="birthRateChangeTimesSASky" value="3.582 1.882 0.682 0"/>
                <parameter name="deathRateChangeTimes" id="deathRateChangeTimesSASky" value="3.582 1.882 0.682 0"/>
                <parameter name="samplingRateChangeTimes" id="samplingRateChangeTimesSASky" value="3.582 1.882 0.682 0"/>
                <reverseTimeArrays spec='parameter.BooleanParameter' value='true true true true true'/> <!-- clarify order of change times, i.e., backwards (true) or fowards (false) -->
            </distribution> <!-- note no option to conditionOnSurvival in the SA package -->

            <!-- Priors on the FBD model parameters -->
            <distribution id="birthRatePriorFBD" spec="beast.math.distributions.Prior" x="@birthRateFBD">
        	  <distr id="birthRateExp" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.1"/>
            </distribution>
            <distribution id="deathRatePriorFBD" spec="beast.math.distributions.Prior" x="@deathRateFBD">
        	  <distr id="deathRateExp" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.1"/>
            </distribution>  
            <distribution id="samplingRatePriorFBD" spec="beast.math.distributions.Prior" x="@samplingRateFBD">
        	  <distr id="samplingRateExp" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.1"/>
            </distribution>  
            <distribution id="originPriorFBD" spec="beast.math.distributions.Prior" x="@originFBD">
	            <distr id="originFBDUniform" spec="beast.math.distributions.Uniform" upper="Infinity"/>
            </distribution>

            <!--Priors on trait model parameters -->
            
            <!-- BM model prior -->
            <!-- trait evolutionary rate, the diagonal elements in the variance-covariance matrix -->
            <distribution id="varValuesPrior" spec="beast.math.distributions.Prior" x="@varValues">
                <distr id="varValuesLogNormal" spec="beast.math.distributions.LogNormalDistributionModel" S="0.3" M="1.0"/>
            </distribution>
            <!-- trait correlations, the off-diagonal elements in the variance-covariance matrix -->
            <distribution id="covValuesPrior" spec="beast.math.distributions.Prior" x="@covValues">
                <distr id="covValuesUniform" spec="beast.math.distributions.Uniform" lower="-1.0" upper="1.0"/>
            </distribution>
            <!-- trait values at the root -->
            <distribution id="rootValuesPrior" spec="beast.math.distributions.Prior" x="@rootValues">
                <distr id="rootValuesNormal" spec="beast.math.distributions.Normal" mean="0.0" sigma="2.0"/>
            </distribution>

            <!-- clock model -->
            <distribution id="rateValuesPrior" spec="beast.math.distributions.Prior" x="@rateValues">
	            <distr id="rateValuesExp" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.2"/>
	        </distribution>
            <distribution id="rateAssignmentsPrior" spec="beast.math.distributions.Prior" x="@rateAssignments">
	            <distr id="rateAssignmentsUniform" spec="beast.math.distributions.Uniform" offset="0.0" lower="0.0" upper="1.0"/>
	        </distribution>

            <!-- insert prior fossil ages here -->

        </distribution>        

        <!-- ** The likelihood ** -->
        <distribution id="likelihood" spec="util.CompoundDistribution" useThreads="true">

            <!-- START Morphological likelihood CONTRABAND-Package -->
            <distribution id="PCMLikelihood" spec="contraband.prunelikelihood.BMPruneLikelihood">

                <tree idref="TheTree"/>
                
                <!-- trait values for species of interest, an array of elements in the trait matrix-->
                <!-- For example
                    trait1 trait2 trait3
                    sp1     T11    T12    T13
                    sp2     T21    T22    T23
                    sp3     T31    T32    T33
                    the input here should be T11 T12 T13 T21 T22 T23 T31 T32 T33
                -->
                <traits id="oneTraitData" spec="parameter.RealParameter" minordimension="3" keys= "TS01_LEpigrav_ASH_Nadap_DobosiEtAl1988_AR_na_3_pseudo_no_18 TS1_Cres_GBS_ThreeHolesCave_BartonRoberts1996_AR_na_1_pseudo_no_1 TS1_EAzil_SWF_Murat_Lorblanchet1985u1996_AR_na_1_pseudo_no_2 TS1_FMag_IBM_ParcoII_Langlais2007_AR_na_1_pseudo_no_20 TS1_LEpigrav_ASH_Zoeld_BeresEtAl2020_AR_p_1_pseudo_no_1 TS1_Mag_PL_Klementowice20_WisniewskiT2015_AR_na_9_pseudo_no_1 TS1_TransMag_SG_Felsstalle_Kind1987_AR_d_1_pseudo_no_9 TS1_TransMag_SG_ZigeunerfelsFG_HornauerJahnkeNoack2019_AR_d_1_pseudo_no_1 TS1_UMag_SWF_BoisRagot_Langlais2018_AR_na_1_pseudo_no_22 TS2_FMag_IBA_LapadosCoelhos3_Gameiro2012_AR_d_1_pseudo_no_2 TS2_Hav_NG_AhrenshoeftLA58d_Weberetal2010fig7_AR_d_1_pseudo_no_3 TS2_Mag_BOMO_Kulna6_Valoch1998_AR_d_1_pseudo_no_7 TS23_EAzil_CH_GrottedeBichon_Chauviere2008_AR_d_1_pseudo_no_5 TS3_Brom_SS_Bromme_Mathiassen1946p1_AR_na_1_pseudo_no_5 TS3_LEpigrav_NEI_PaluEchen_Dalmerietal2013_AR_d_1_pseudo_no_4 TS3_LEpigrav_NEI_RiparoDalmeriUpperlayers_Bassettietal1998_AR_na_1_pseudo_no_21 TS3_Sauv_IBM_CingledelAigua_Roman2011_AR_na_1_pseudo_no_18 TS3_Sauv_IBM_Pena14_Sotoetal2019_AR_na_1_pseudo_no_13 TS3_Wito_PL_Rotnowo18ll_Galinski2007_AR_p_1_pseudo_no_1 TS34_LPal_SG_BadBuchauKappel_Joachimetal2015_AR_p_1_pseudo_no_2 TS4_Ahr_SS_SyltholmVII_Mage2019_AR_na_1_pseudo_no_1 TS4_AzilTSG_ASH_Unken_Windisch2014_AR_d_1_pseudo_no_1 TS4_BeurA_SG_JagerhaushohleSchicht13_Taute1971_AR_na_1_pseudo_no_30 TS4_ELab_SWF_PortdePenne_Langlais2020_AR_d_1_pseudo_no_5 TS4_ESauv_NEI_RomagnanoLocIIIlayerAE_Bartolomeietal1984_AR_na_1_pseudo_no_45 TS4_LAzil_IBA_Bocas0_Bicho1999_AR_na_1_pseudo_no_1 TS4_REpigrav_ASH_Altwasser_JagherFischerMorel1997_AR_na_3_pseudo_no_1 TS4_Swid_LT_Kabeliai2_Ostrauskas2002_AR_d_1_pseudo_no_1 TS4_SwidAhr_PL_Kochlew1_Cyrek1996_AR_d_2_pseudo_no_1 TS4_SwidAhr_PL_WojnowoAcutIII75_Kobusiewicz2016_AR_d_4_pseudo_no_1 TS45_FBT_GBS_ThreeWaysWharfCWest_LewisandRackham2011_AR_p_1_pseudo_no_14 TS5_EMeso_GBS_StarCarr_Milneretal2018_AR_na_1_pseudo_no_4">
                0.115771088699815 -0.108679192884551 0.07441402097774 -0.967373958842064 0.220726526269515 0.0348868973140436 -0.449641411476792 -0.0693831863477515 0.00786487371844014 -0.401690497425311 -0.0884799491890865 0.0706768862578099 -0.139532137462901 -0.124812180174675 0.0300151145496439 1.10439522633584 0.591440263335987 0.0157728824349729 0.378317251192013 -0.0224228734541386 -0.0398781609259097 -0.520237778716694 -0.0289274417769614 -0.0672496637094919 0.433168784343114 -0.0319643183409251 0.059256023763349 0.32813474062251 -0.0709294851445727 0.0684715485211133 0.0917134982032201 -0.12675201045262 0.123789282867776 0.460841885010073 -0.00373790633943834 -0.0152985898058655 -1.05709329583726 0.303534380896046 0.0410523820642661 1.21692394063785 0.815214352468623 0.015484713282358 -0.75767113867965 0.0823803859077113 -0.0398678084075661 0.332030873902746 -0.0703725325827505 0.12675718789302 -0.0894391120140704 -0.10936219738527 -0.0745842979597272 0.187724491256668 -0.0224171731083664 -0.28362482927718 -0.0803315945881556 -0.129937685023744 -0.0239598794285664 -0.235268519562288 -0.0765251954047744 -0.136461940141197 0.0967676242790463 -0.109037673182921 0.00686030924859885 0.283295568744511 -0.0833065270164293 0.018004422171411 0.279364984738683 -0.0209200058211724 -0.183482210270651 0.341798271574815 -0.049166793186841 0.0286681568001054 0.00946556860361828 -0.132778508294158 0.0961398466083622 0.141238433254142 -0.107118865636056 0.0376116070381838 0.20566688743559 -0.0445322925402085 -0.16899753612221 -0.936380946585486 0.227254845557592 -0.0548228150809639 -0.221885888820668 -0.0932509782223542 -0.0739262524969335 -1.44112949441237 0.962226702307181 0.134485555899477 -0.410938876130504 -0.0683566560212154 -0.0300354411091678 -0.532194853996504 -0.0154183381633884 -0.0647501662796454
                </traits>

                <!-- the morphological clock model -->
                <branchRateModel id="rateCatClock" spec="contraband.clock.RateCategoryClockModel" nCat="2">
                    <rates id="rateValues" spec="parameter.RealParameter" lower="0" upper="1000">0.00000001 0.00000005</rates>
                    <rateCatAssign id="rateAssignments" spec="parameter.IntegerParameter" lower="0" upper="1">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</rateCatAssign>
                    <tree idref="TheTree"/>
                </branchRateModel>

                <!-- parameters in the BM model -->
                <!-- here we assume each trait has its own evolutionary rate -->
                <!-- if we assume all traits to share one common rate, we should set the flag by oneRateOnly="true" -->
                <!-- the flag upperMatrix="true" here is to ensure the non-singular variance-covariance matrix -->
                <nodeMath id="pcmNodeMath" spec="contraband.math.NodeMath" traits="@oneTraitData" upperMatrix="true">
                    <sigmasq id="varValues" spec="parameter.RealParameter">1.0</sigmasq>
                    <correlation id="covValues" spec="parameter.RealParameter">0.0</correlation>
                    <rootValues id="rootValues" spec="parameter.RealParameter">0.0</rootValues>
                </nodeMath>
            </distribution> <!-- END Morphological (PCM) likleihood -->            
        </distribution> <!-- End Likelihood -->
    </distribution> <!-- End Posterior -->

    <!-- ** MCMC moves ** - I have shuffled these into non-arbitrary groups -->
    <!-- FBD model parameters -->
    <operator id="birthRateFBDScaler.t" spec="ScaleOperator" parameter="@birthRateFBD" weight="3.0"/>
    <operator id="deathRateFBDScaler.t" spec="ScaleOperator" parameter="@deathRateFBD" weight="3.0"/>
    <operator id="samplingRateFBDScaler.t" spec="ScaleOperator" parameter="@samplingRateFBD" weight="3.0"/>
    <operator id="originScalerFBD" spec="ScaleOperator" parameter="@originFBD" scaleFactor="0.75" weight="3.0"/>    
    <!-- parameters in the BM model -->
    <operator id="varValueScaler" spec="ScaleOperator" parameter="@varValues" scaleFactor="0.75" weight="6.0"/>
    <operator id="covValueRandomWalk" spec="RealRandomWalkOperator" parameter="@covValues" windowSize="1.0" weight="10.0"/>
    <operator id="rootValuesRandomWalk" spec="RealRandomWalkOperator" parameter="@rootValues" windowSize="1.0" weight="6.0"/>
    <!-- clock model --> 
    <operator id="rateAssignmentWalker" spec="IntRandomWalkOperator" parameter="@rateAssignments" windowSize="1" weight="10.0"/>
    <operator id="rateValueScaler" spec="ScaleOperator" parameter="@rateValues" scaleFactor="0.75" weight="3.0"/>
    <!-- tree topology -->
    <operator id="LeafToSAFBD" spec="LeafToSampledAncestorJump" tree="@TheTree" weight="10.0"/>
    <operator id="SAWilsonBaldingFBD" spec="SAWilsonBalding" tree="@TheTree" weight="10.0"/>
    <operator id="SAWideFBD" spec="SAExchange" isNarrow="false" tree="@TheTree" weight="10.0"/>
    <operator id="SANarrowFBD" spec="SAExchange" tree="@TheTree" weight="10.0"/>
    <operator id="SAUniformOperatorFBD" spec="SAUniform" tree="@TheTree" weight="20.0"/>
    <operator id="SATreeRootScalerFBD" spec="SAScaleOperator" rootOnly="true" scaleFactor="0.95" tree="@TheTree" weight="1.0"/>
    <operator id="SATreeScalerFBD" spec="SAScaleOperator" scaleFactor="0.42" tree="@TheTree" weight="3.0"/>

    <!-- Insert moves on fossil ages -->

    <!-- ** Parameters to log to file ** -->
    <logger id="tracelog" fileName="TAXA_32_PCs_3/independent_run_2/output/FBD_skyline.log" logEvery="500000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="prior"/>
        <log idref="likelihood"/>        
        <log idref="PCMLikelihood"/>
        <log idref="FBD"/>
        <log id="TreeHeight.t" spec="beast.evolution.tree.TreeHeightLogger" tree="@TheTree"/>
        <log id="SACountFBD" spec="beast.evolution.tree.SampledAncestorLogger" tree="@TheTree"/>
        <!-- FBD model parameters -->
        <log idref="birthRateFBD"/>
        <log idref="deathRateFBD"/>
        <log idref="samplingRateFBD"/>
        <log idref="rFBD"/>
        <log idref="rhoFBD"/>
        <log idref="originFBD"/>
        <!-- Clock model parameters -->        
        <log idref="rateValues"/>
        <log idref="rateAssignments"/>
        <!-- BM model parameters -->
        <log idref="varValues"/>
        <log idref="covValues"/>
        <log idref="rootValues"/>
        <!-- Insert fossil ages -->
    </logger>

    <!-- screenlog -->
    <logger id="screenlog" spec="Logger" logEvery="500000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

    <!-- treelog -->
    <logger id="treelog.t" spec="Logger" fileName="TAXA_32_PCs_3/independent_run_2/output/FBD_skyline.trees" logEvery="500000" mode="tree">
        <log id="TreeWithMetaDataLogger" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@TheTree" branchratemodel="@rateCatClock" sort="false"/>
    </logger>

</run>

</beast>
