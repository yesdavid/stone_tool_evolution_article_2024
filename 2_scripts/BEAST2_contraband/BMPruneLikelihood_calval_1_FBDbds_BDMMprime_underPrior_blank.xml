<?xml version="1.0" encoding="UTF-8" standalone="no"?><beast beautitemplate='Standard' beautistatus='' namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="" version="2.6">
    <data
id="dnaSequence"
spec="Alignment"
name="alignment">
       
	   DNA_SEQUENCE_PLACEHOLDER
	   
	   </data>

    


    <map name="Uniform" >beast.math.distributions.Uniform</map>
    <map name="Exponential" >beast.math.distributions.Exponential</map>
    <map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
    <map name="Normal" >beast.math.distributions.Normal</map>
    <map name="Beta" >beast.math.distributions.Beta</map>
    <map name="Gamma" >beast.math.distributions.Gamma</map>
    <map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
    <map name="prior" >beast.math.distributions.Prior</map>
    <map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
    <map name="OneOnX" >beast.math.distributions.OneOnX</map>
	<map name="Dirichlet" >beast.math.distributions.Dirichlet</map>
	
	
    <run id="mcmc" spec="MCMC" chainLength="CHAINLENGTH_PLACEHOLDER"  sampleFromPrior="true">
        <state id="state" spec="State" storeEvery="5000">
            <tree id="TheTree" spec="beast.evolution.tree.Tree" name="stateNode">
                
				<taxonset id="TaxonSet" spec="TaxonSet">
		TAXON_ID_PLACEHOLDER
	            </taxonset>
                <trait id="FossilSet" spec="beast.evolution.tree.TraitSet" traitname="date-backward">
		FOSSILSET_PLACEHOLDER
                    <taxa idref="TaxonSet"/>
                </trait>
			</tree>
			
            <parameter id="birthRateCanonical.t" spec="parameter.RealParameter" dimension="N_TIMEBINS_PLACEHOLDER" name="stateNode">BIRTH_TIMEBINS_PLACEHOLDER</parameter>
            <parameter id="deathRateCanonical.t" spec="parameter.RealParameter" dimension="N_TIMEBINS_PLACEHOLDER" name="stateNode">DEATH_TIMEBINS_PLACEHOLDER</parameter>
            <parameter id="samplingRateCanonical.t" spec="parameter.RealParameter" dimension="N_TIMEBINS_PLACEHOLDER" name="stateNode">SAMPLING_TIMEBINS_PLACEHOLDER</parameter>
			
			<parameter id="rhoSamplingProb" spec="parameter.RealParameter" name="stateNode">0.0</parameter>
			
            <parameter id="originBDMMPrime.t" spec="parameter.RealParameter" name="stateNode">10.0</parameter>
            <parameter id="typeFrequencies.t" spec="parameter.RealParameter" lower="0.0" name="stateNode" upper="1.0">1.0</parameter>
            <parameter id="clockRate.c" spec="parameter.RealParameter" name="stateNode">1.0</parameter>
			
			<stateNode idref="varValues"/>
			<stateNode idref="rootValues"/>
			<stateNode idref="covValues"/>
			
        </state>
		
		<!-- Initialise a random TheTree to start the chain -->
        <init id="RandomTheTree" spec="beast.evolution.tree.RandomTree" estimate="false" initial="@TheTree" taxa="@dnaSequence">
            <populationModel id="ConstantPopulation0.t" spec="ConstantPopulation">
                <parameter id="randomPopSize.t" spec="parameter.RealParameter" name="popSize">1.0</parameter>
            </populationModel>
        </init>
		
		
        <distribution id="posterior" spec="util.CompoundDistribution">
            <distribution id="prior" spec="util.CompoundDistribution">
                <distribution id="BDMMPrime.t" spec="bdmmprime.distribution.BirthDeathMigrationDistribution" conditionOnSurvival="false" frequencies="@typeFrequencies.t" tree="@TheTree">
                    <parameterization id="CanonicalBDMMPrimeParameterization.t" spec="bdmmprime.parameterization.CanonicalParameterization" origin="@originBDMMPrime.t">
                        
						<birthRate id="birthRateSVCanonical.t" spec="bdmmprime.parameterization.SkylineVectorParameter" origin="@originBDMMPrime.t" skylineValues="@birthRateCanonical.t" timesAreAges="true">
                            <parameter id="birthRateChangeTimesCanonical.t" spec="parameter.RealParameter" estimate="false" lower="0.0" name="changeTimes">CHANGE_TIMES_PLACEHOLDER</parameter>
                            <typeSet id="typeSetBDMMPrime.t" spec="bdmmprime.parameterization.TypeSet">
                                <typeTraitSet id="typeTraitSet.t" spec="bdmmprime.util.InitializedTraitSet" traitname="type" value="TYPETRAITSET_PLACEHOLDER">
                                    <taxa id="TaxonSet.1" spec="TaxonSet" alignment="@dnaSequence"/>
                                </typeTraitSet>
                            </typeSet>
                        </birthRate>
						
                        <deathRate id="deathRateSVCanonical.t" spec="bdmmprime.parameterization.SkylineVectorParameter" origin="@originBDMMPrime.t" skylineValues="@deathRateCanonical.t" timesAreAges="true" typeSet="@typeSetBDMMPrime.t">
                            <parameter id="deathRateChangeTimesCanonical.t" spec="parameter.RealParameter" estimate="false" lower="0.0" name="changeTimes">CHANGE_TIMES_PLACEHOLDER</parameter>
                        </deathRate>
						
						 <samplingRate id="samplingRateSVCanonical.t" spec="bdmmprime.parameterization.SkylineVectorParameter" origin="@originBDMMPrime.t" skylineValues="@samplingRateCanonical.t" timesAreAges="true" typeSet="@typeSetBDMMPrime.t">
                            <parameter id="samplingRateChangeTimesCanonical.t" spec="parameter.RealParameter" estimate="false" lower="0.0" name="changeTimes">CHANGE_TIMES_PLACEHOLDER</parameter>
                        </samplingRate>
						
						<rhoSampling id="rhoSamplingProbTPCanonical.t" spec="bdmmprime.parameterization.TimedParameter" origin="@originBDMMPrime.t" timesAreAges="true" typeSet="@typeSetBDMMPrime.t">
                            <parameter id="rhoSamplingProbTimesCanonical.t" spec="parameter.RealParameter" estimate="false" name="times">0.0</parameter>
                            <parameter id="rhoSamplingProbCanonical.t" spec="parameter.RealParameter" estimate="false" name="values"> 0.00000001</parameter>
                        </rhoSampling>
                        
						<removalProb id="removalProbSVCanonical.t" spec="bdmmprime.parameterization.SkylineVectorParameter" origin="@originBDMMPrime.t" timesAreAges="true" typeSet="@typeSetBDMMPrime.t">
                            <parameter id="removalProbChangeTimesCanonical.t" spec="parameter.RealParameter" estimate="false" lower="0.0" name="changeTimes">CHANGE_TIMES_PLACEHOLDER</parameter>
                            <parameter id="removalProbCanonical.t" spec="parameter.RealParameter" dimension="2" estimate="false" lower="0.0" name="skylineValues" upper="1.0">REMOVALPROB_TIMEBINS_PLACEHOLDER</parameter>
                        </removalProb>
						
                        <migrationRate id="migrationRateSMCanonical.t" spec="bdmmprime.parameterization.SkylineMatrixParameter" origin="@originBDMMPrime.t" timesAreAges="true" typeSet="@typeSetBDMMPrime.t">
                            <parameter id="migrationRateCanonical.t" spec="parameter.RealParameter" estimate="false" name="skylineValues">1.0</parameter>
                        </migrationRate>
						
                        <birthRateAmongDemes id="birthRateAmongDemesSMCanonical.t" spec="bdmmprime.parameterization.SkylineMatrixParameter" origin="@originBDMMPrime.t" timesAreAges="true" typeSet="@typeSetBDMMPrime.t">
                            <parameter id="birthRateAmongDemesCanonical.t" spec="parameter.RealParameter" estimate="false" name="skylineValues">1.0</parameter>
                        </birthRateAmongDemes>
						
                        <typeSet idref="typeSetBDMMPrime.t"/>
                    </parameterization>
					
                    <typeTraitSet idref="typeTraitSet.t"/>
                </distribution>
				
                <distribution id="birthRateCanonicalPrior.t" spec="bdmmprime.util.priors.ZeroExcludingPrior" x="@birthRateCanonical.t">
                    <Exponential id="Exponential.1" name="distr">
                        <parameter id="RealParameter.4" spec="parameter.RealParameter" estimate="false" name="mean">BDS_EXPONENTIAL_MEAN_PLACEHOLDER</parameter>
                    </Exponential>
                </distribution>
				
                <prior id="ClockPrior.c" name="distribution" x="@clockRate.c">
                    <Exponential id="Exponential.4" name="distr">
                        <parameter id="RealParameter.7" spec="parameter.RealParameter" estimate="false" name="mean">BDS_EXPONENTIAL_MEAN_PLACEHOLDER</parameter>
                    </Exponential>
                </prior>
				
                <distribution id="deathRateCanonicalPrior.t" spec="bdmmprime.util.priors.ZeroExcludingPrior" x="@deathRateCanonical.t">
                    <Exponential id="Exponential.2" name="distr">
                        <parameter id="RealParameter.5" spec="parameter.RealParameter" estimate="false" name="mean">BDS_EXPONENTIAL_MEAN_PLACEHOLDER</parameter>
                    </Exponential>
                </distribution>
				
				<!--
                <prior id="originBDMMPrimePrior.t" name="distribution" x="@originBDMMPrime.t">
                    <OneOnX id="OneOnX.1" name="distr"/>
                </prior>
				-->
				<distribution id="origin" spec="beast.math.distributions.Prior" x="@originBDMMPrime.t">
					<distr id="FBDoriginUniform" spec="beast.math.distributions.Uniform" upper="Infinity"/>
				</distribution>
				
                <distribution id="samplingRateCanonicalPrior.t" spec="bdmmprime.util.priors.ZeroExcludingPrior" x="@samplingRateCanonical.t">
                    <Exponential id="Exponential.3" name="distr">
                        <parameter id="RealParameter.6" spec="parameter.RealParameter" estimate="false" name="mean">BDS_EXPONENTIAL_MEAN_PLACEHOLDER</parameter>
                    </Exponential>
                </distribution>
            </distribution>
			
			
			<!-- BM model prior -->
			<!-- trait evolutionary rate, the diagonal elements in the variance-covariance matrix -->
			<distribution id="varValuesPrior" spec="beast.math.distributions.Prior" x="@varValues">
				<distr id="LogNormal.varValues" spec="beast.math.distributions.LogNormalDistributionModel" S="0.3" M="1.0"/>
			</distribution>
			<!-- trait correlations, the off-diagonal elements in the variance-covariance matrix -->
			<distribution id="covValuesPrior" spec="beast.math.distributions.Prior" x="@covValues">
				<distr id="Uniform.correlation" spec="beast.math.distributions.Uniform" lower="-1.0" upper="1.0"/>
			</distribution>
			<!-- trait values at the root -->
			<distribution id="MeanPrior" spec="beast.math.distributions.Prior" x="@rootValues">
				<distr id="Normal.Mean" spec="beast.math.distributions.Normal" mean="0.0" sigma="2.0"/>
			</distribution>


			<!-- insert prior fossil ages here -->
			
			 <distribution id="likelihood" spec="util.CompoundDistribution" useThreads="true">

		    </distribution>
			
			<!-- START Morphological likleihood-->
			<distribution id="PCMLikelihood" spec="contraband.prunelikelihood.BMPruneLikelihood">
				<tree idref="TheTree"/>
					<!-- trait values for species of interest, an array of elements in the trait matrix-->
					<!-- For example
						  trait1 trait2 trait3
					sp1     T11    T12    T13
					sp2     T21    T22    T23
					sp3     T31    T32    T33
					the input here should be T11 T12 T13 T21 T22 T23 T31 T32 T33
					-->
					<traits id="oneTraitData" spec="parameter.RealParameter" minordimension="MINORDIMENSION_PLACEHOLDER" 
					keys= "ONETRAITDATA_PLACEHOLDER">
					TRAITDATA_PLACEHOLDER
					</traits>

					<!-- the morphological clock model used here is equivalent to a strict clock -->
					<!-- the rates input here refers to the branch rates -->
					<branchRateModel id="rateCatClock" spec="contraband.clock.RateCategoryClockModel" nCat="1">
						<rates id="rateValues" spec="parameter.RealParameter">1</rates>
						<rateCatAssign id="rateAssignments" spec="parameter.IntegerParameter" lower="0" upper="1">0</rateCatAssign>
					<tree idref="TheTree"/>
				</branchRateModel>

				<!-- parameters in the BM model -->
				<!-- here we assume each trait has its own evolutionary rate -->
				<!-- if we assume all traits to share one common rate, we should set the flag by oneRateOnly="true" -->
				<!-- the flag upperMatrix="true" here is to ensure the non-singular variance-covariance matrix -->
				<nodeMath id="pcmNodeMath" spec="contraband.math.NodeMath" traits="@oneTraitData" upperMatrix="true">
					<sigmasq id="varValues" spec="parameter.RealParameter">1.0</sigmasq>
					<correlation id="covValues" spec="parameter.RealParameter">0.0</correlation>
					<rootValues id="rootValues" spec="parameter.RealParameter">0.0</rootValues>
				</nodeMath>
        </distribution>
        <!-- END Morphological likleihood -->
			
			
        </distribution>
		
		
        <operator id="birthRateCanonicalScaler.t" spec="ScaleOperator" parameter="@birthRateCanonical.t" weight="3.0"/>
        <operator id="deathRateCanonicalScaler.t" spec="ScaleOperator" parameter="@deathRateCanonical.t" weight="3.0"/>
        <operator id="samplingRateCanonicalScaler.t" spec="ScaleOperator" parameter="@samplingRateCanonical.t" weight="3.0"/>
        <operator id="BDMMPrimeLeafToSA.t" spec="LeafToSampledAncestorJump" tree="@TheTree" weight="10.0"/>
        <operator id="BDMMPrimeSAWilsonBalding.t" spec="SAWilsonBalding" tree="@TheTree" weight="10.0"/>
        <operator id="BDMMPrimeSAWide.t" spec="SAExchange" isNarrow="false" tree="@TheTree" weight="10.0"/>
        <operator id="BDMMPrimeSANarrow.t" spec="SAExchange" tree="@TheTree" weight="10.0"/>
        <operator id="BDMMPrimeSAUniformOperator.t" spec="SAUniform" tree="@TheTree" weight="20.0"/>
        <operator id="BDMMPrimeSATreeRootScaler.t" spec="SAScaleOperator" rootOnly="true" scaleFactor="0.95" tree="@TheTree" weight="1.0"/>
        <operator id="BDMMPrimeSATreeScaler.t" spec="SAScaleOperator" scaleFactor="0.95" tree="@TheTree" weight="3.0"/>
        <operator id="originBDMMPrimeScaler.t" spec="ScaleOperator" parameter="@originBDMMPrime.t" weight="3.0"/>
        <operator id="typeFrequenciesExchanger.t" spec="DeltaExchangeOperator" delta="0.1" weight="1.0">
            <parameter idref="typeFrequencies.t"/>
        </operator>
        <operator id="StrictClockRateScaler.c" spec="ScaleOperator" parameter="@clockRate.c" weight="3.0"/>
        <operator id="strictClockUpDownOperator.c" spec="UpDownOperator" scaleFactor="0.75" weight="3.0">
            <up idref="clockRate.c"/>
            <down idref="TheTree"/>
        </operator>
		
		<!-- parameters in the BM model -->
		<operator id="VarValueScaler" spec="ScaleOperator" parameter="@varValues" scaleFactor="0.75" weight="6.0"/>
		<operator id="CoValueRandomWalk" spec="RealRandomWalkOperator" parameter="@covValues" windowSize="1.0" weight="10.0"/>
		<operator id="MeanRandomWalk" spec="RealRandomWalkOperator" parameter="@rootValues" windowSize="1.0" weight="6.0"/>
		
		
        <logger id="tracelog" spec="Logger" fileName="BMPruneLikelihood_calval_1.log" logEvery="PRINTGEN_PLACEHOLDER" model="@posterior" sanitiseHeaders="true" sort="smart">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
			<log id="TreeHeight.t" spec="beast.evolution.tree.TreeHeightLogger" tree="@TheTree"/>
            <log idref="birthRateSVCanonical.t"/>
            <log idref="birthRateAmongDemesSMCanonical.t"/>
            <log idref="deathRateSVCanonical.t"/>
            <log idref="migrationRateSMCanonical.t"/>
            <log idref="samplingRateSVCanonical.t"/>
            <log idref="removalProbSVCanonical.t"/>
            <log idref="rhoSamplingProbTPCanonical.t"/>
            <log idref="birthRateAmongDemesCanonical.t"/>
            <log idref="originBDMMPrime.t"/>
            <log idref="typeFrequencies.t"/>
			<!--
            <log id="typedTheTreeats.t" spec="bdmmprime.mapping.TypedNodeTreeLogger" includeRootEdge="true" typeLabel="type" typeSet="@typeSetBDMMPrime.t">
                <typedTree id="typeMappedTheTree" spec="bdmmprime.mapping.TypeMappedTree" bdmmDistrib="@BDMMPrime.t" frequencies="@typeFrequencies.t" mapOnInit="false" remapOnLog="true" typeLabel="type" typeTraitSet="@typeTraitSet.t" untypedTree="@TheTree"/>
            </log>
			-->
            <log idref="clockRate.c"/>
			
			<!-- parameters in the BM model -->
			<log idref="varValues"/>
			<log idref="covValues"/>
			<log idref="rootValues"/>
			
			
        </logger>
		
		
        <logger id="screenlog" spec="Logger" logEvery="PRINTGEN_PLACEHOLDER">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
			<log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        </logger>
		
        <logger id="treelog.t" spec="Logger" fileName="BMPruneLikelihood_calval_1.trees" logEvery="PRINTGEN_PLACEHOLDER" mode="tree">
            <log id="TreeWithMetaDataLogger.t" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@TheTree"/>
        </logger>
		<!--
        <logger id="typedTreeLogger.t" spec="bdmmprime.util.OptionalLogger" fileName="BMPruneLikelihood_calval_1.typed.trees" logEvery="PRINTGEN_PLACEHOLDER" mode="tree">
            <log idref="typeMappedTheTree"/>
        </logger>
		
        <logger id="nodeTypedTreeLogger.t" spec="bdmmprime.util.OptionalLogger" fileName="BMPruneLikelihood_calval_1.typed.node.trees" logEvery="PRINTGEN_PLACEHOLDER" mode="tree">
            <log id="nodeTypedTheTree" spec="bdmmprime.mapping.TypedNodeTreeLogger" typedTree="@typeMappedTheTree"/>
        </logger>
        <logger id="trajLogger.t" spec="bdmmprime.util.OptionalLogger" fileName="BMPruneLikelihood_calval_1.traj" logEvery="1000">
            <log id="typedTraj.t" spec="bdmmprime.trajectories.SampledTrajectory" bdmmDistrib="@BDMMPrime.t" frequencies="@typeFrequencies.t" typeMappedTree="@typeMappedTheTree" useTauLeaping="true"/>
        </logger>
		-->
		
        <operatorschedule id="OperatorSchedule" spec="OperatorSchedule"/>
		
		
    </run>
</beast>
